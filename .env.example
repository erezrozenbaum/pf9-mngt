# PF9 Management Portal - Environment Configuration Template
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control!

# Database Configuration (PostgreSQL)
POSTGRES_USER=pf9
POSTGRES_PASSWORD=<GENERATE_STRONG_PASSWORD>
POSTGRES_DB=pf9_mgmt

# Platform9 API Credentials (Service Account)
PF9_USERNAME=<PLATFORM9_SERVICE_USER>
PF9_PASSWORD=<PLATFORM9_PASSWORD>
PF9_AUTH_URL=<KEYSTONE_URL>/keystone/v3
PF9_USER_DOMAIN=Default
PF9_PROJECT_NAME=service
PF9_PROJECT_DOMAIN=Default
PF9_REGION_NAME=region-one
PF9_REGION_URL=<REGION_URL>
PF9_VERIFY_TLS=true

# Web Portal Admin Credentials
PF9_ADMIN_USERNAME=<ADMIN_EMAIL>
PF9_ADMIN_PASSWORD=<ADMIN_PASSWORD>

# Portal Security
PF9_ALLOWED_ORIGIN=https://your-domain.com

# Database Connection (for API and scripts)
PF9_DB_HOST=db
PF9_DB_PORT=5432
PF9_DB_NAME=pf9_mgmt
PF9_DB_USER=pf9
PF9_DB_PASSWORD=<SAME_AS_POSTGRES_PASSWORD>

# pgAdmin Configuration (Database Management UI)
PGADMIN_EMAIL=<ADMIN_EMAIL>
PGADMIN_PASSWORD=<PGADMIN_PASSWORD>

# Report Output Directory (cross-platform; defaults to ~/Reports/Platform9 if unset)
PF9_OUTPUT_DIR=./reports

# Monitoring Configuration
PF9_HOSTS=<COMMA_SEPARATED_HOST_IPS>
# Map host IPs to friendly hostnames (format: IP:HOSTNAME,IP:HOSTNAME)
# PF9_HOST_MAP=10.0.1.10:host-01,10.0.1.11:host-02
METRICS_CACHE_TTL=60
LOG_LEVEL=INFO

# SSH Log Collection (for System Logs tab)
# IPs of PF9 compute hosts that the API can SSH into for log retrieval
SSH_PF9_HOSTS=<COMMA_SEPARATED_SSH_HOST_IPS>
PF9_SSH_USER=pf9
PF9_SSH_PASSWORD=<SSH_PASSWORD>
# PF9_SSH_KEY_PATH=<PATH_TO_SSH_PRIVATE_KEY>

# LDAP Directory Service Configuration
LDAP_ORGANISATION=<ORGANIZATION_NAME>
LDAP_DOMAIN=<DOMAIN_NAME>
LDAP_ADMIN_PASSWORD=<LDAP_ADMIN_PASSWORD>
LDAP_CONFIG_PASSWORD=<LDAP_CONFIG_PASSWORD>
LDAP_READONLY_USER=true
LDAP_READONLY_PASSWORD=<LDAP_READONLY_PASSWORD>
# LDAP_BASE_DN, LDAP_USER_DN, LDAP_GROUP_DN are auto-derived from LDAP_DOMAIN
# by deployment.ps1 (e.g. company.com -> dc=company,dc=com)
# LDAP_BASE_DN=dc=company,dc=com
# LDAP_USER_DN=ou=users,dc=company,dc=com
# LDAP_GROUP_DN=ou=groups,dc=company,dc=com

# Web Portal Admin User
DEFAULT_ADMIN_USER=<ADMIN_USERNAME_OR_EMAIL>
DEFAULT_ADMIN_PASSWORD=<ADMIN_PASSWORD>

# LDAP demo user passwords (used by setup_ldap.ps1; generated randomly if unset)
VIEWER_PASSWORD=<GENERATE_STRONG_PASSWORD>
OPERATOR_PASSWORD=<GENERATE_STRONG_PASSWORD>

# JWT Authentication Secret (auto-generated by deployment.ps1)
# Generate manually: openssl rand -base64 64
JWT_SECRET_KEY=<GENERATE_RANDOM_64_CHAR_SECRET>

# Snapshot Automation Configuration
SNAPSHOT_SCHEDULER_ENABLED=true
POLICY_ASSIGN_INTERVAL_MINUTES=60
AUTO_SNAPSHOT_INTERVAL_MINUTES=60
AUTO_SNAPSHOT_MAX_SIZE_GB=200
COMPLIANCE_REPORT_ENABLED=true
COMPLIANCE_REPORT_INTERVAL_MINUTES=1440
COMPLIANCE_REPORT_SLA_DAYS=2
SNAPSHOT_PASSWORD_KEY=<GENERATE_ENCRYPTION_KEY>
SNAPSHOT_USER_PASSWORD_ENCRYPTED=<ENCRYPTED_PASSWORD>

# Snapshot Service User (for per-tenant snapshot creation)
# The service user must exist in Platform9 Keystone.
# Set the plaintext password here OR use the encrypted pair above.
SNAPSHOT_SERVICE_USER_EMAIL=<SNAPSHOT_SERVICE_USER_EMAIL>

# Snapshot Restore Feature
# Allows operators/admins to restore VMs from Cinder volume snapshots
RESTORE_ENABLED=false

# Docker volume mount for reports (used in docker-compose.yml)
# PF9_REPORTS_DIR=./reports

# UI API Base URL (override for non-localhost deployments)
# VITE_API_BASE=http://localhost:8000
# UI Monitoring Service URL (override for non-localhost deployments)
# VITE_MONITORING_BASE=http://localhost:8001
RESTORE_DRY_RUN=false
RESTORE_CLEANUP_VOLUMES=false
SNAPSHOT_SERVICE_USER_PASSWORD=<SERVICE_USER_PASSWORD>

# ═══════════════════════════════════════════════════════════════════════
# Email Notifications (SMTP)
# ═══════════════════════════════════════════════════════════════════════
# Set SMTP_ENABLED=true to activate email notifications.
# The notification worker container polls for new events (drift, snapshot
# failures, compliance violations, health score drops) and sends emails.
#
# ── Option A: SMTP WITHOUT authentication (internal relay / local MTA) ──
# Typical for internal mail relays that accept unauthenticated connections.
# Leave SMTP_USERNAME and SMTP_PASSWORD empty, set SMTP_USE_TLS=false,
# and use port 25.
#
# SMTP_ENABLED=true
# SMTP_HOST=mail-relay.internal.local
# SMTP_PORT=25
# SMTP_USE_TLS=false
# SMTP_USERNAME=
# SMTP_PASSWORD=
# SMTP_FROM_ADDRESS=pf9-mgmt@yourdomain.com
# SMTP_FROM_NAME=Platform9 Management
#
# ── Option B: SMTP WITH authentication (Gmail, O365, SES, etc.) ────────
# Uses STARTTLS on port 587 with username/password authentication.
#
# SMTP_ENABLED=true
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USE_TLS=true
# SMTP_USERNAME=you@gmail.com
# SMTP_PASSWORD=your-app-password
# SMTP_FROM_ADDRESS=pf9-mgmt@yourdomain.com
# SMTP_FROM_NAME=Platform9 Management
#
# ── Uncomment ONE of the options above and fill in your values: ────────
SMTP_ENABLED=false
SMTP_HOST=
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_ADDRESS=pf9-mgmt@example.com
SMTP_FROM_NAME=Platform9 Management

# Notification Worker Behavior
# Poll interval (seconds) — how often the worker checks for new events
NOTIFICATION_POLL_INTERVAL_SECONDS=120
# Daily digest — batches low-priority events into a single daily email
NOTIFICATION_DIGEST_ENABLED=true
# Hour (UTC) to send digests (0-23)
NOTIFICATION_DIGEST_HOUR_UTC=8
# Health score threshold — tenants below this score trigger alerts
HEALTH_ALERT_THRESHOLD=50

# ═══════════════════════════════════════════════════════════════════════
# DATABASE CONNECTION POOL (per worker process)
# ═══════════════════════════════════════════════════════════════════════
# DB_POOL_MIN_CONN=2   # Minimum connections per worker (default: 2)
# DB_POOL_MAX_CONN=10  # Maximum connections per worker (default: 10)
# With 4 Gunicorn workers: total max = 4 × 10 = 40 connections
# PostgreSQL default max_connections is 100
